---
import Carousel from "../components/Carousel.astro";

const projects = [
  "/projects/02 Project Two.png",
  "/projects/03 Project Three.png",
  "/projects/04 Project Four.png",
  "/projects/05 Project Five.png",
  "/projects/06 Project Six.png",
];
---

<main>
  <Carousel width="wide" class="home-carousel">
    <h1 class="title">Projects</h1>

    <div class="carousel" id="projects-carousel">
      <ul class="track">
        {projects.map((src, i) => (
          <li class="slide">
            <img src={src} alt={`Project ${i + 2}`} loading={i === 0 ? "eager" : "lazy"} />
          </li>
        ))}
      </ul>

      <div class="dots">
        {projects.map((_, i) => (
          <button
            class="dot"
            data-index={i}
            aria-label={`Go to slide ${i + 1}`}
          />
        ))}
      </div>
    </div>
  </Carousel>
</main>

<script>
  const carousel = document.getElementById("projects-carousel");
  const track = carousel.querySelector(".track");
  const dots = carousel.querySelectorAll(".dot");

  const updateDots = () => {
    const index = Math.round(track.scrollLeft / track.clientWidth);
    dots.forEach((dot, i) =>
      dot.toggleAttribute("data-active", i === index)
    );
  };

  dots.forEach((dot, i) => {
    dot.addEventListener("click", () => {
      track.scrollTo({
        left: i * track.clientWidth,
        behavior: "smooth",
      });
    });
  });

  track.addEventListener("scroll", () => {
    window.requestAnimationFrame(updateDots);
  });

  updateDots();
</script>

<style>
  .home-carousel {
    padding-top: 2rem;
    padding-bottom: 3rem;
  }

  .title {
    margin-bottom: 1rem;
    font-size: 2rem;
  }

  /* --- Carousel --- */
  .carousel {
    position: relative;
  }

  .track {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  .track::-webkit-scrollbar {
    display: none;
  }

  .slide {
    flex: 0 0 100%;
    scroll-snap-align: center;
    border-radius: 16px;
    overflow: hidden;
  }

  .slide img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
  }

  /* --- Custom dots --- */
  .dots {
    margin-top: 0.9rem;
    display: flex;
    justify-content: center;
    gap: 10px;
  }

  .dot {
    width: 10px;
    height: 10px;
    border-radius: 999px;
    border: none;
    background: currentColor;
    opacity: 0.35;
    cursor: pointer;
    transition: transform 160ms ease, opacity 160ms ease;
  }

  .dot[data-active] {
    opacity: 1;
    transform: scale(1.35);
  }
</style>
